<!DOCTYPE html>
<html>
<head>
  <title>Google Maps Route Test</title>
  <style>
    #map {
      height: 100vh;
      width: 100%;
    }
    .info-panel {
      position: absolute;
      top: 10px;
      left: 10px;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      z-index: 5;
      font-family: Arial, sans-serif;
    }
    .info-panel h3 {
      margin: 0 0 10px 0;
      color: #1a73e8;
    }
    .transport-buttons {
      display: flex;
      gap: 5px;
      margin-top: 10px;
    }
    .transport-buttons button {
      padding: 8px 12px;
      border: 1px solid #dadce0;
      background: white;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    .transport-buttons button:hover {
      background: #f8f9fa;
    }
    .transport-buttons button.active {
      background: #1a73e8;
      color: white;
    }
    .route-info {
      margin-top: 10px;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 4px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  
  <div class="info-panel">
    <h3>üó∫Ô∏è Click Map for Directions</h3>
    <p style="font-size: 14px; color: #5f6368; margin: 5px 0;">
      Click anywhere on the map to calculate route
    </p>
    
    <div class="transport-buttons">
      <button id="driving" class="active" onclick="setMode('DRIVING')">üöó Driving</button>
      <button id="walking" onclick="setMode('WALKING')">üö∂ Walking</button>
      <button id="bicycling" onclick="setMode('BICYCLING')">üö¥ Cycling</button>
      <button id="transit" onclick="setMode('TRANSIT')">üöå Transit</button>
    </div>
    
    <div id="route-info" class="route-info" style="display: none;">
      <strong>Route Details:</strong><br>
      <span id="route-details">No route calculated</span>
    </div>
  </div>

  <script>
    let map;
    let directionsService;
    let directionsRenderer;
    let currentMode = 'DRIVING';
    let userLocation = { lat: 37.7749, lng: -122.4194 }; // Default to San Francisco

    function initMap() {
      // Try to get user's current location
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (position) => {
            userLocation = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };
            initializeMap();
          },
          () => {
            console.log('Location access denied, using default');
            initializeMap();
          }
        );
      } else {
        initializeMap();
      }
    }

    function initializeMap() {
      // Create map
      map = new google.maps.Map(document.getElementById('map'), {
        center: userLocation,
        zoom: 13,
        mapTypeControl: false,
        fullscreenControl: true,
        streetViewControl: true,
        zoomControl: true
      });

      // Initialize directions service and renderer
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({
        map: map,
        suppressMarkers: false, // Show A and B markers
        suppressInfoWindows: false, // Show info windows
        draggable: false,
        polylineOptions: {
          strokeColor: '#4285F4',
          strokeOpacity: 1.0,
          strokeWeight: 5,
          geodesic: true
        },
        markerOptions: {
          animation: google.maps.Animation.DROP
        }
      });

      // Add current location marker
      new google.maps.Marker({
        position: userLocation,
        map: map,
        title: 'Your Location',
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          scale: 10,
          fillColor: '#4285F4',
          fillOpacity: 1,
          strokeColor: '#ffffff',
          strokeWeight: 2
        }
      });

      // Add click listener
      map.addListener('click', (event) => {
        calculateRoute(userLocation, event.latLng);
      });
    }

    function calculateRoute(origin, destination) {
      const request = {
        origin: origin,
        destination: destination,
        travelMode: google.maps.TravelMode[currentMode],
        unitSystem: google.maps.UnitSystem.METRIC,
        avoidHighways: false,
        avoidTolls: false,
        provideRouteAlternatives: false
      };

      directionsService.route(request, (result, status) => {
        if (status === 'OK') {
          // Display route
          directionsRenderer.setDirections(result);
          
          // Show route info
          const route = result.routes[0];
          const leg = route.legs[0];
          document.getElementById('route-info').style.display = 'block';
          document.getElementById('route-details').innerHTML = `
            <strong>Distance:</strong> ${leg.distance.text}<br>
            <strong>Duration:</strong> ${leg.duration.text}<br>
            <strong>From:</strong> ${leg.start_address}<br>
            <strong>To:</strong> ${leg.end_address}
          `;
        } else {
          alert('Could not calculate route: ' + status);
        }
      });
    }

    function setMode(mode) {
      currentMode = mode;
      
      // Update button states
      document.querySelectorAll('.transport-buttons button').forEach(btn => {
        btn.classList.remove('active');
      });
      document.getElementById(mode.toLowerCase()).classList.add('active');
      
      // Clear current route
      directionsRenderer.setDirections({routes: []});
      document.getElementById('route-info').style.display = 'none';
    }
  </script>

  <!-- Replace YOUR_API_KEY with your actual Google Maps API key -->
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap">
  </script>
</body>
</html>